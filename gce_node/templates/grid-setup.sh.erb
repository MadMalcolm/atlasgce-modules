# Keep grid setup out of environment for root and sysadmin.
if [[ ! "$USER" =~ ^slot[0-9]+$ ]] ; then
  return 0
fi

export GLOBUS_FTP_CLIENT_GRIDFTP2=true

## fix for atlas software location disappearing from condor job environment
export VO_ATLAS_SW_DIR=/cvmfs/atlas.cern.ch/repo/sw

## Set up grid environment:
export ATLAS_LOCAL_ROOT_BASE=/cvmfs/atlas.cern.ch/repo/ATLASLocalRootBase
source $ATLAS_LOCAL_ROOT_BASE/user/atlasLocalSetup.sh --quiet

# Use EMI grid software
<% if @use_emi_grid_software -%>
localSetupEmi --quiet
export ALRB_useGridSW=emi
<% else -%>
localSetupGLite --quiet
export ALRB_useGridSW=gLite
<% end -%>

## Fix for using AtlasLocalRootBase with a kit
#unset  AtlasSetupSite
#
rm ~/.asetup

# Site-specific variables (e.g. Frontier and Squid servers) are set based on
# ATLAS_SITE_NAME. This auto-setup is only temporarily needed,
# and will soon become automatic (I wonder when and how I will know?)
. /cvmfs/atlas.cern.ch/repo/sw/local/bin/auto-setup

